<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ОСИС - Админ панель</title>
        <link rel="stylesheet" href="css/admin.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    </head>
<body>
    <div class="header_wrapper">
        <div class="container">
            <div class="header">
                <a href="/"><img src="image/Logo.svg" alt="" class="menu_logo"></a>
                <div class="links">
                    <a href="#orders" class="link">Заказы</a>
                    <a href="#review" class="link">Отзывы</a>
                    <a href="#news" class="link">новости</a>
                    <a href="#projects" class="link">проекты</a>
                    <a href="#users" class="link">Пользователи</a>
                </div>
                <div class="header__burger">
                    <span></span>
                </div>
                
            </div>
        </div>
    </div>
    <main>
        <div class="container">
            <h1>Панель администратора</h1>

        <h2>Заявки</h2>
        <div id="orders"></div>
        <table>
            <thead>
                <tr>
                    <th>ID заказа</th>
                    <th>Клиент</th>
                    <th>Дата заказа</th>
                    <th>Тип заказа</th>
                    <th>Информация</th>
                    <th>Статус</th>
                    <th>Контакты</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody>
                <% orders.forEach(order => { %>
                <tr>
                    <td><%= order.order_id %></td>
                    <td><%= order.User.first_name %> <%= order.User.last_name %></td>
                    <td><%= new Date(order.order_date).toLocaleString() %></td>
                    <td><%= order.type %></td>
                    <td><%= order.information %></td>
                    <td><%= order.status %></td>
                    <td><%= order.User.email %> <br> <%= order.User.phone %></td>
                    <td style="display: flex;">
                        <form action="/admin/edit-order/<%= order.order_id %>" method="post">
                            <select name="status" id="status">
                                <option value="" disabled selected>Статус</option>
                                <option value="pending">Ожидает</option>
                                <option value="accept">Принят</option>
                                <option value="ready">Готов</option>
                                <option value="canceled">Отменён</option>
                            </select>
                            <button type="submit">Изменить</button>
                        </form>
                        <a href="/admin/del-order/<%= order.order_id %>" >Удалить</a>
                    </td>
                </tr>
                <% }); %>
            </tbody>
        </table>

        <h2>Отзывы</h2>
        <div id="review"></div>
        <table>
            <thead>
                <tr>
                    <th>ID отзыва</th>
                    <th>Клиент</th>
                    <th>Контакты</th>
                    <th>Текст</th>
                    <th>Статус</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody>
                <% reviews.forEach(review => { %>
                <tr>
                    <td><%= review.review_id %></td>
                    <td><%= review.User.first_name %> <%= review.User.last_name %></td>
                    <td><%= review.User.email %> <br> <%= review.User.phone %></td>
                    <td><%= review.text %></td>
                    <td><%= review.status %></td>
                    <td style="display: flex; flex-direction: column; align-items: flex-start;">
                        <form action="/admin/edit-review/<%= review.review_id %>" method="post" style="display: flex;">
                            <select name="status" id="status">
                                <option value="not confirmed" selected>Не подтвержден</option>
                                <option value="confirmed">Подтвержден</option>
                            </select>
                            <button type="submit">Изменить</button>
                        </form>
                        <a href="/admin/del-review/<%= review.review_id %>" >Удалить</a>
                    </td>
                </tr>
                <% }); %>
            </tbody>
        </table>

        <h2>Новости</h2>
        <div id="news"></div>
        <table>
            <thead>
                <tr>
                    <th>ID новости</th>
                    <th>Картинка</th>
                    <th>Заголовок</th>
                    <th>Текст</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody>
                <% news.forEach(newс => { %>
                    <tr>
                        <td><%= newс.news_id %></td>
                        <td><img src="image/<%= newс.image %>" alt="" style="width: 300px;"></td>
                        <td><%= newс.header %></td>
                        <td><%= newс.text %></td>
                        <td><a href="/admin/del-news/<%= newс.news_id %>" >Удалить</a></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
        <h2>Добавление новости</h2>
        <form action="/admin/create-news" method="post" enctype="multipart/form-data" class="news">
            <label for="title">Заголовок новости</label>
            <input type="text" name="title" placeholder="Введите заголовок" required>
            
            <label for="content">Текст новости</label>
            <textarea name="content" placeholder="Введите текст новости" required></textarea>
            
            <label for="image">Изображение</label>
            <input type="file" name="image" required>
            
            <button type="submit">Опубликовать новость</button>
        </form>

        <h2>Проекты</h2>
        <div id="projects"></div>
        <table>
            <thead>
                <tr>
                    <th>ID Проекта</th>
                    <th>Регион</th>
                    <th>Название</th>
                    <th>Текст</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody>
                <% projects.forEach(project => { %>
                    <tr>
                        <td><%= project.project_id %></td>
                        <td><%= project.region %></td>
                        <td><%= project.name %></td>
                        <td><%= project.text %></td>
                        <td><a href="/admin/del-projects/<%= project.projects_id %>" >Удалить</a></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
        
        <h2>Добавление проекта</h2>
        <form action="/admin/create-project" method="post" enctype="multipart/form-data" class="news">
            <label for="region">Регион</label>
            <input type="text" name="region" placeholder="Введите Регион" required>
            
            <label for="name">Название</label>
            <input type="text" name="name" placeholder="Введите Название" required>

            <label for="text">Текст проекта</label>
            <textarea name="text" placeholder="Введите текст проекта" required></textarea>
            
            <button type="submit">Опубликовать проект</button>
        </form>

        <h2>Пользователи</h2>
        <div id="users"></div>
        <table>
            <thead>
                <tr>
                    <th>ID user</th>
                    <th>Роль</th>
                    <th>email</th>
                    <th>Фамилия Имя</th>
                    <th>Телефон</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody>
                <% users.forEach(user => { %>
                    <tr>
                        <td><%= user.user_id %></td>
                        <td><%= user.Role.role %></td>
                        <td><%= user.email %></td>
                        <td><%= user.last_name %> <%= user.first_name %></td>
                        <td><%= user.phone %></td>
                        <td><a href="/admin/del-users/<%= user.user_id %>" >Удалить</a></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
        </div>
    </main>
    <footer>
        <div class="container">
            <div class="footer_content">
                <div class="silki">
                    <div class="navigation">
                        <p class="zaglav">Навигация</p>
                        <a href="#about">О компании</a>
                        <a href="#prob">Задачи</a>
                        <a href="#proj">Проекты</a>
                        <a href="#part">Партнеры</a>
                    </div>
                    <div class="tel">
                        <p class="zaglav">Звонок нам</p>
                        <p>+7(912)846-48-48</p>
                    </div>
                    <div class="pochta">
                        <p class="zaglav">Почта</p>
                        <p>info@osis.su</p>
                    </div>
                    <div class="mesto">
                        <p class="zaglav">Местоположение</p>
                        <p>г. Оренбург ул. Туркестанская, д.5 офис 610</p>
                    </div>
                </div>
                <img src="image/Logo.svg" alt="" class="footer_logo">
                <p class="prava">© 2020-2024 ООО "Открытие системы и сервисы" Все права защищены.</p>
            </div>
        </div>
    </footer>
    <script src="js/script.js"></script>
</body>
</html>